{% extends "base.html" %}

{% block title %}Drill Participation - DisasterReady{% endblock %}

{% block styles %}
<!-- Add drill-specific styles here if needed -->
{% endblock %}

{% block content %}
<div class="drill-container">
    <!-- Drill Header -->
    <div class="drill-header">
        <h1>Drill Participation</h1>
        <p>Practice and prepare for emergencies through virtual and physical drills</p>
    </div>

    <!-- Drill Content -->
    <div class="drill-content">
        <div class="drill-types">
            <!-- Virtual Drill -->
            <div class="drill-card">
                <div class="drill-card-header">
                    <i class="fas fa-desktop"></i>
                    <h2>Virtual Drills</h2>
                </div>
                <p>Practice emergency procedures in a safe, simulated environment. Virtual drills help you learn proper responses without real-world risks.</p>

                <div class="drill-features">
                    <h3>What you'll practice:</h3>
                    <ul class="feature-list">
                        <li>Earthquake response procedures</li>
                        <li>Fire evacuation routes</li>
                        <li>Flood safety protocols</li>
                        <li>First aid basics</li>
                        <li>Emergency communication</li>
                    </ul>
                </div>

                <div class="drill-actions">
                    <button class="btn-drill btn-drill-primary" onclick="startVirtualDrill()">
                        <i class="fas fa-play"></i> Start Virtual Drill
                    </button>
                    <button class="btn-drill btn-drill-secondary">
                        <i class="fas fa-info-circle"></i> Learn More
                    </button>
                </div>
            </div>

            <!-- Physical Drill -->
            <div class="drill-card">
                <div class="drill-card-header">
                    <i class="fas fa-running"></i>
                    <h2>Physical Drills</h2>
                </div>
                <p>Participate in scheduled on-site drills to practice emergency response in real-world scenarios with guidance from instructors.</p>

                <div class="drill-features">
                    <h3>Next scheduled drills:</h3>
                    <ul class="feature-list">
                        <li>Earthquake Drill - Friday, Oct 15, 10:00 AM</li>
                        <li>Fire Evacuation Drill - Tuesday, Oct 19, 2:30 PM</li>
                        <li>Lockdown Drill - Monday, Oct 25, 9:00 AM</li>
                    </ul>
                </div>

                <div class="drill-actions">
                    <button class="btn-drill btn-drill-primary">
                        <i class="fas fa-calendar-check"></i> Schedule Participation
                    </button>
                    <button class="btn-drill btn-drill-secondary">
                        <i class="fas fa-list"></i> View All Drills
                    </button>
                </div>
            </div>
        </div>

        <div class="drill-sidebar">
            <!-- Progress Tracking -->
            <div class="sidebar-card">
                <h3><i class="fas fa-chart-line"></i> Your Drill Progress</h3>
                <div class="achievement-stats">
                    <div class="stat">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Drills Completed</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">7</div>
                        <div class="stat-label">Badges Earned</div>
                    </div>
                </div>
            </div>

            <!-- Upcoming Drills -->
            <div class="sidebar-card">
                <h3><i class="fas fa-calendar-alt"></i> Upcoming Drills</h3>
                <ul class="upcoming-drills">
                    <li class="upcoming-drill">
                        <h4>Earthquake Drill</h4>
                        <p>Main campus - All buildings</p>
                        <div class="drill-date">
                            <i class="fas fa-clock"></i> Fri, Oct 15 • 10:00 AM
                        </div>
                    </li>
                    <li class="upcoming-drill">
                        <h4>Fire Evacuation</h4>
                        <p>Science building only</p>
                        <div class="drill-date">
                            <i class="fas fa-clock"></i> Tue, Oct 19 • 2:30 PM
                        </div>
                    </li>
                    <li class="upcoming-drill">
                        <h4>Lockdown Drill</h4>
                        <p>All classrooms</p>
                        <div class="drill-date">
                            <i class="fas fa-clock"></i> Mon, Oct 25 • 9:00 AM
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Earned Badges -->
            <div class="sidebar-card">
                <h3><i class="fas fa-award"></i> Your Badges</h3>
                <div class="badges-container">
                    <div class="badge">
                        <i class="fas fa-fire-extinguisher"></i>
                        <h4>Fire Safety Expert</h4>
                        <p>Completed 5 fire drills</p>
                    </div>
                    <div class="badge">
                        <i class="fas fa-house-damage"></i>
                        <h4>Earthquake Ready</h4>
                        <p>Mastered earthquake safety</p>
                    </div>
                    <div class="badge">
                        <i class="fas fa-first-aid"></i>
                        <h4>First Aid Pro</h4>
                        <p>First aid certification</p>
                    </div>
                    <div class="badge">
                        <i class="fas fa-medal"></i>
                        <h4>Drill Champion</h4>
                        <p>10 drills completed</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Virtual Drill Modal -->
<div class="modal" id="virtualDrillModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Virtual Earthquake Drill</h2>
            <button class="close-modal" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="simulation-container">
                <div class="simulation-scenario">
                    <h3>Scenario: Earthquake During Class</h3>
                    <p>You're in a classroom when a strong earthquake begins. The ground is shaking violently, and objects are falling from shelves.</p>
                    <p>What should you do first?</p>
                </div>

                <div class="simulation-actions">
                    <div class="simulation-action" onclick="selectAction(this, 'correct')">
                        <i class="fas fa-people-arrows"></i>
                        <h4>Drop, Cover, and Hold On</h4>
                        <p>Get under a sturdy desk and hold on</p>
                    </div>
                    <div class="simulation-action" onclick="selectAction(this, 'incorrect')">
                        <i class="fas fa-running"></i>
                        <h4>Run Outside Immediately</h4>
                        <p>Quickly exit the building</p>
                    </div>
                    <div class="simulation-action" onclick="selectAction(this, 'incorrect')">
                        <i class="fas fa-door-open"></i>
                        <h4>Stand in a Doorway</h4>
                        <p>Move to the nearest doorway</p>
                    </div>
                    <div class="simulation-action" onclick="selectAction(this, 'incorrect')">
                        <i class="fas fa-elevator"></i>
                        <h4>Take the Elevator</h4>
                        <p>Use elevator to evacuate quickly</p>
                    </div>
                </div>

                <div class="simulation-feedback" id="simulationFeedback">
                    <!-- Feedback will be inserted here -->
                </div>

                <div class="simulation-progress">
                    <div class="progress-info">
                        <span>Question 1 of 5</span>
                        <span>20% Complete</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 20%;"></div>
                    </div>
                </div>

                <button class="btn-drill btn-drill-primary" id="nextQuestionBtn" style="width: 100%; margin-top: 1.5rem; display: none;">
                    <i class="fas fa-arrow-right"></i> Next Question
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Virtual Drill functionality
    function startVirtualDrill() {
        document.getElementById('virtualDrillModal').style.display = 'flex';
        resetSimulation();
    }

    function closeModal() {
        document.getElementById('virtualDrillModal').style.display = 'none';
    }

    function resetSimulation() {
        const actions = document.querySelectorAll('.simulation-action');
        actions.forEach(action => {
            action.classList.remove('correct', 'incorrect');
        });
        document.getElementById('simulationFeedback').style.display = 'none';
        document.getElementById('nextQuestionBtn').style.display = 'none';
    }

    function selectAction(element, correctness) {
        const actions = document.querySelectorAll('.simulation-action');
        actions.forEach(action => {
            action.classList.remove('correct', 'incorrect');
        });

        element.classList.add(correctness);

        const feedback = document.getElementById('simulationFeedback');
        feedback.style.display = 'block';

        if (correctness === 'correct') {
            feedback.className = 'simulation-feedback feedback-correct';
            feedback.innerHTML = `
                <h4><i class="fas fa-check-circle"></i> Correct!</h4>
                <p>During an earthquake, you should immediately Drop, Cover, and Hold On. Getting under a sturdy desk protects you from falling objects.</p>
            `;
        } else {
            feedback.className = 'simulation-feedback feedback-incorrect';
            feedback.innerHTML = `
                <h4><i class="fas fa-times-circle"></i> Incorrect</h4>
                <p>Running outside during an earthquake is dangerous due to falling debris. The safest action is to Drop, Cover, and Hold On.</p>
            `;
        }

        document.getElementById('nextQuestionBtn').style.display = 'flex';
    }

    window.onclick = function(event) {
        const modal = document.getElementById('virtualDrillModal');
        if (event.target === modal) {
            closeModal();
        }
    }

    document.getElementById('nextQuestionBtn').addEventListener('click', function() {
        alert('In a real application, this would load the next question in the virtual drill.');
        closeModal();
    });
</script>
{% endblock %}
